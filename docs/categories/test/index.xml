<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>æµ‹è¯• on æ…•æ«çš„leaf</title><link>https://mapleafgo.github.io/categories/test/</link><description>Recent content in æµ‹è¯• on æ…•æ«çš„leaf</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Thu, 04 Mar 2021 16:06:29 +0800</lastBuildDate><atom:link href="https://mapleafgo.github.io/categories/test/index.xml" rel="self" type="application/rss+xml"/><item><title>Jmeter ç”¨è„šæœ¬å¤„ç†å™¨å¯¹æ•°æ®è¿›è¡Œå¤„ç†</title><link>https://mapleafgo.github.io/posts/jmeter/jsr223/</link><pubDate>Thu, 04 Mar 2021 16:06:29 +0800</pubDate><guid>https://mapleafgo.github.io/posts/jmeter/jsr223/</guid><description>&lt;blockquote>
&lt;p>å‰ä¸¤å¤©åœ¨é¡¹ç›®ä¸­å†™ jmeter æµ‹è¯•è„šæœ¬ï¼Œé¡¹ç›®ä¸­å”¯ä¸€ ID å¾—è°ƒç”¨ç«¯è¯·æ±‚æ—¶ç”Ÿæˆå¹¶ä¼ é€ï¼Œäºæ˜¯æŸ¥èµ„æ–™ã€ç¿»å®˜ç½‘æ–‡æ¡£ï¼Œç»ˆäºå†™å‡ºæ¥äº†ã€‚&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>ç¤ºä¾‹ä¸­æˆ‘ä»¬ä½¿ç”¨ç®€å•çš„ç™¾åº¦ç¿»è¯‘çš„è¯å…¸ API è¯·æ±‚ json æ•°æ®ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>è¯´æ˜ä¸‹ï¼Œè¿™é‡Œä¸ºå•¥è¦ç”¨ groovy è„šæœ¬ï¼Œå› ä¸ºå®˜ç½‘è¯´ groovy è„šæœ¬ä¼šç¼“å­˜ç¼–è¯‘ç»“æœï¼Œå¯æé«˜æ€§èƒ½ã€‚è€Œä¸” groovy è„šæœ¬åŸºæœ¬è·Ÿ Java æ²¡å•¥åŒºåˆ«&lt;/p>
&lt;h3 id="é¦–å…ˆå…ˆåˆ›å»ºä¸ªç®€å•çš„-http-è¯·æ±‚">é¦–å…ˆå…ˆåˆ›å»ºä¸ªç®€å•çš„ HTTP è¯·æ±‚&lt;/h3>
&lt;ul>
&lt;li>æ‰“å¼€ jmeter åï¼Œå…ˆåœ¨æ ¹èŠ‚ç‚¹(Test Plan)ä¸‹æ–°å»ºä¸ªçº¿ç¨‹ç»„(Thread Group)ï¼Œé»˜è®¤çš„çº¿ç¨‹ç»„é…ç½®å°±å¤Ÿæˆ‘ä»¬æœ¬æ¬¡ç¤ºä¾‹ç”¨äº†&lt;/li>
&lt;li>åœ¨çº¿ç¨‹ç»„ä¸‹æ–°å»ºä¸ª Http è¯·æ±‚(HTTP Request)ï¼Œå†æ–°å»ºä¸ªç»“æœæ ‘å±•ç¤º(View Results Tree)&lt;/li>
&lt;li>é…ç½® Http è¯·æ±‚ï¼Œé¦–å…ˆæ˜¯åè®®(Protocol): &lt;code>https&lt;/code> ï¼ŒæœåŠ¡åœ°å€(Server Name): &lt;code>fanyi.baidu.com&lt;/code> ï¼Œè¯·æ±‚ç±»å‹: &lt;code>POST&lt;/code> ï¼ŒPath: &lt;code>/sug&lt;/code>&lt;/li>
&lt;li>æ·»åŠ ä¸ªè¯·æ±‚å‚æ•°(Parameters)ï¼Œç‚¹å‡»&lt;code>Add&lt;/code>ï¼ŒName: &lt;code>kw&lt;/code>ï¼ŒValue: &lt;code>test&lt;/code>&lt;/li>
&lt;li>ç‚¹å‡»è¿è¡Œï¼Œæˆ–è€…ä½¿ç”¨å¿«æ·é”®&lt;code>Ctrl+R&lt;/code>ï¼Œè¿è¡Œç»“æŸåœ¨ç»“æœæ ‘ä¸­æŸ¥çœ‹ç»“æœï¼Œçœ‹çœ‹æ˜¯å¦è¯·æ±‚æˆåŠŸ&lt;/li>
&lt;/ul>
&lt;h3 id="åœ¨å‘èµ·è¯·æ±‚å‰å¡«å……æ•°æ®">åœ¨å‘èµ·è¯·æ±‚å‰ï¼Œå¡«å……æ•°æ®&lt;/h3>
&lt;blockquote>
&lt;p>é¦–å…ˆè¯´è¯´æˆ‘ä»¬è¦è¾¾åˆ°çš„é¢„æœŸï¼Œæˆ‘ä»¬è¦åœ¨è¯·æ±‚å‚æ•°ä¸­æ¸…ç†æ‰åŸæœ¬&lt;code>kw&lt;/code>å‚æ•°çš„&lt;code>test&lt;/code>å€¼ï¼Œå¡«å……ä¸Šæ–°çš„å‚æ•°å€¼&lt;code>success&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>åœ¨å†™ä¸‹é¢çš„ä¸œè¥¿å‰ï¼Œå…ˆé™„ä¸Š&lt;a class="link" href="https://jmeter.apache.org/usermanual/component_reference.html#JSR223_PreProcessor" target="_blank" rel="noopener"
>å®˜æ–¹æ–‡æ¡£&lt;/a>ï¼Œè¿™æ˜¯ JSR233 å‰ç½®å¤„ç†å™¨çš„æ–‡æ¡£ã€‚&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>
&lt;p>å…ˆåœ¨ Http è¯·æ±‚èŠ‚ç‚¹ä¸‹æ–°å»ºä¸ª JSR223 å‰ç½®å¤„ç†å™¨(JSR223 PreProcessor)ï¼Œå½“ç„¶ï¼Œä¹Ÿå¯ä»¥åœ¨åŒçº§èŠ‚ç‚¹å»º(ä¸è¿‡å¿…é¡»è¦åœ¨è¯·æ±‚èŠ‚ç‚¹å)ï¼ŒåŒçº§å»ºçš„è¯ï¼Œå¤„ç†å™¨çš„ä½œç”¨åŸŸå°±æ˜¯åŒçº§èŠ‚ç‚¹çš„æ‰€æœ‰è¯·æ±‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>é€‰æ‹©è„šæœ¬ &lt;code>groovy&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç¼–å†™è„šæœ¬&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// è·å–è¯·æ±‚å‚æ•°
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kt">def&lt;/span> &lt;span class="n">params&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">sampler&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">getArguments&lt;/span>&lt;span class="o">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// è·å–ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè¿™é‡Œæ’åºè·Ÿè¯·æ±‚èŠ‚ç‚¹çš„å‚æ•°é¡ºåºæŒ‚é’©
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kt">def&lt;/span> &lt;span class="n">kw&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">params&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">getArgument&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// èµ‹äºˆkwæ–°å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">kw&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">setValue&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;success&amp;#34;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>è¿è¡Œæµ‹è¯•ä¸‹è¯·æ±‚å‚æ•°æ˜¯å¦å·²ç»æ›´æ”¹&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>å†™åˆ°è¿™é‡Œï¼Œæˆ‘çœŸçš„å¿ä¸ä½æƒ³åæ§½ä¸‹ï¼Œè¿™è¯·æ±‚å‚æ•°è—çš„å¤Ÿæ·±çš„å•Š ğŸ˜‘ å®˜æ–¹æ–‡æ¡£ä¹Ÿæ²¡å†™è¿™ç‚¹ï¼Œè¦ä¸æ˜¯çœ‹ API æ–‡æ¡£ï¼Œè¿˜çœŸå°±ä¸ä¸€å®šå‘ç°çš„äº† Argumentsã€‚å®˜æ–¹æ–‡æ¡£é‡Œ &lt;code>Parameters&lt;/code>ã€&lt;code>args&lt;/code>ã€&lt;code>ctx&lt;/code>ã€&lt;code>props&lt;/code>éƒ½è¯•äº†ï¼Œæ´»ç”Ÿç”Ÿè®©æˆ‘è¯•å‡ºæ¥çš„å•Š ğŸ˜¤ï¼ï¼ï¼&lt;/p>
&lt;h3 id="åœ¨è¯·æ±‚ç»“æŸåå¯¹è¿”å›çš„æ•°æ®è¿›è¡Œæ ¼å¼åŒ–å¤„ç†">åœ¨è¯·æ±‚ç»“æŸåï¼Œå¯¹è¿”å›çš„æ•°æ®è¿›è¡Œæ ¼å¼åŒ–å¤„ç†&lt;/h3>
&lt;blockquote>
&lt;p>è¿”å›æ•°æ®çš„å¤„ç†ï¼Œä¸»è¦æ˜¯å¯¹è¿”å›çš„æ•°æ®è¿›è¡Œè§£ç ã€Json æ ¼å¼çš„ç¼©è¿›å±•ç¤º&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>åç½®å¤„ç†å°±æ–¹ä¾¿çš„å¤šäº†ï¼Œåœ¨ JSR223 åç½®å¤„ç†å™¨(JSR223 PostProcessor)ä¸­ï¼Œæœ‰&lt;code>prev&lt;/code>å‚æ•°å¯ç›´æ¥æ“ä½œç»“æœé›†&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>
&lt;p>åŒå‰ç½®å¤„ç†å™¨ä¸€æ ·ï¼Œå…ˆå»ºä¸ª JSR223 åç½®å¤„ç†å™¨èŠ‚ç‚¹ï¼Œä½œç”¨åŸŸåŒå‰ç½®å¤„ç†å™¨&lt;/p>
&lt;/li>
&lt;li>
&lt;p>åŒæ ·ï¼Œè„šæœ¬é€‰æ‹©&lt;code>groovy&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç¼–å†™è„šæœ¬&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-groovy" data-lang="groovy">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">groovy.json.JsonOutput&lt;/span>&lt;span class="o">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">org.apache.commons.lang3.StringEscapeUtils&lt;/span>&lt;span class="o">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// å­—ç¬¦ä¸²çš„å½¢å¼è¯»å–è¿”å›æ•°æ®
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kt">def&lt;/span> &lt;span class="n">data&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">prev&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">getResponseDataAsString&lt;/span>&lt;span class="o">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// æ ¼å¼åŒ–jsonæ•°æ®
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kt">def&lt;/span> &lt;span class="n">json&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">JsonOutput&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">prettyPrint&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// å¯¹æ•°æ®è¿›è¡ŒUnicodeè½¬ä¸­æ–‡çš„è§£ç 
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kt">def&lt;/span> &lt;span class="n">ret&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">StringEscapeUtils&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">unescapeJava&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">json&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// æŠŠæˆ‘ä»¬è½¬æ¢åçš„æ•°æ®è®¾ç½®ä¸ºè¿”å›ç»“æœï¼Œç¼–ç è®¾ç½®ä¸ºUTF-8
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">prev&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="na">setResponseData&lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="n">ret&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="s2">&amp;#34;UTF-8&amp;#34;&lt;/span>&lt;span class="o">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>è¿è¡Œæµ‹è¯•ç»“æœï¼Œå®Œç¾ç»“æŸï¼&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>è‡³æ­¤æ•´ä¸ªå‰ç½®åç½®çš„å¤„ç†å°±å®Œç¾äº†&lt;/p></description></item></channel></rss>